!function(e,t){for(var r in t)e[r]=t[r]}(exports,function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)}([function(e,t){e.exports=require("react")},function(e,t){e.exports=require("react-router-dom")},function(e,t){e.exports=require("react-redux")},function(e,t){e.exports=require("@kever/ioc")},function(e,t){e.exports=require("react-dom/server")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("redux")},function(e,t){e.exports=require("isomorphic-fetch")},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return S}));var n=r(0),o=r.n(n),a=r(4),i=r(1),c=r(3),l=(r(7),r(5)),u=r(2);let s;!function(e){e[e.INCREASE=0]="INCREASE",e[e.REDUCE=1]="REDUCE"}(s||(s={}));const p=({message:e})=>{const t=Object(u.useSelector)(e=>e),r=Object(u.useDispatch)();return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,"Hello Home ",e),o.a.createElement("button",{onClick:()=>{console.log("123"),r({type:s.INCREASE,data:{name:t.name,age:t.age+1}})}},"年龄相加"),o.a.createElement("div",null,"姓名： ",t.name),o.a.createElement("div",null,"年龄： ",t.age))};p.initialAction=async()=>{const e=await fetch("http://127.0.0.1:9000/api/user/getUser"),t=await e.json();return{type:s.INCREASE,data:t}};var f=[{path:"/render",name:"Home",component:p,exact:!0},{path:"/render/about",name:"About",component:({message:e})=>o.a.createElement("div",null,"Hello About"),exact:!0}];function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var d=({message:e})=>o.a.createElement("div",null,o.a.createElement("ul",null,f.map(e=>o.a.createElement("li",{key:e.path},o.a.createElement(i.Link,{to:e.path},e.name)))),o.a.createElement("p",null,e),o.a.createElement(i.Switch,null,f.map(e=>o.a.createElement(i.Route,m({key:e.path},e))))),h=r(6);const g={name:"",age:0};var E=(e=g,t)=>{switch(t.type){case s.INCREASE:case s.REDUCE:return{...e,...t.data};default:return e}};var b,v=e=>Object(h.createStore)(E,e);function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let S=Object(c.registerPlugin)("SSRPlugin",c.PluginType.global)(b=class{constructor(){y(this,"template",void 0),y(this,"routes",void 0),y(this,"store",void 0),this.template=l.readFileSync("./lib/assets/index.html","utf8"),this.routes=f,this.store=v()}async ready(e,t){if(this.checkRouteUrl(e.url)){const t=await this.getRenderToString(e.url),r=JSON.stringify(this.store.getState()),n=this.template.replace("\x3c!--inject-script--\x3e",`\n      <script> window.INITIAL_STORE=${r}<\/script>\n      `).replace("\x3c!--inject-ssr--\x3e",t);e.body=n}else await t()}checkRouteUrl(e){for(let t of this.routes)if(Object(i.matchPath)(e,t))return!0;return!1}async getStore(){let e=[];for(let t of this.routes)if(t.component&&t.component.initialAction){const r=await t.component.initialAction(),n=this.store.dispatch(r);e.push(Promise.resolve(n))}return e}async getRenderToString(e){await Promise.all(await this.getStore());console.log("store",this.store.getState());return Object(a.renderToString)(o.a.createElement(u.Provider,{store:this.store},o.a.createElement(i.StaticRouter,{location:e,context:{}},o.a.createElement(d,null))))}})||b}]));